/home/zihan/anaconda3/envs/x/lib/python3.7/site-packages/ecos/ecos.py:26: UserWarning: Converting G to a CSC matrix; may take a while.
  warn("Converting G to a CSC matrix; may take a while.")
/home/zihan/anaconda3/envs/x/lib/python3.7/site-packages/ecos/ecos.py:29: UserWarning: Converting A to a CSC matrix; may take a while.
  warn("Converting A to a CSC matrix; may take a while.")
pygame 2.0.1 (SDL 2.0.14, Python 3.7.0)
Hello from the pygame community. https://www.pygame.org/contribute.html
pong_v2 pettingzoo
Load pong_v2 environment in type pettingzoo.
Env observation space: Box(0.0, 1.0, (128,), float32) action space: Discrete(6)
random seed: 91
<mars.env.wrappers.mars_wrappers.Dict2TupleWrapper object at 0x7f59cbc0f668>
DQNBase(
  (net): MLP(
    (body): Sequential(
      (0): Linear(in_features=128, out_features=128, bias=True)
      (1): ReLU()
      (2): Linear(in_features=128, out_features=128, bias=True)
      (3): ReLU()
      (4): Linear(in_features=128, out_features=128, bias=True)
      (5): ReLU()
      (6): Linear(in_features=128, out_features=128, bias=True)
      (7): ReLU()
      (8): Linear(in_features=128, out_features=6, bias=True)
    )
  )
)
DQNBase(
  (net): MLP(
    (body): Sequential(
      (0): Linear(in_features=128, out_features=128, bias=True)
      (1): ReLU()
      (2): Linear(in_features=128, out_features=128, bias=True)
      (3): ReLU()
      (4): Linear(in_features=128, out_features=128, bias=True)
      (5): ReLU()
      (6): Linear(in_features=128, out_features=128, bias=True)
      (7): ReLU()
      (8): Linear(in_features=128, out_features=6, bias=True)
    )
  )
)
Agents No. [0] (index starting from 0) are not learnable.
Load meta strategy:  [array([0.014, 0.014, 0.014, ..., 0.014, 0.014, 0.014]) array([0.014, 0.014, 0.014, ..., 0.014, 0.014, 0.014])]
Load checkpoints (policy family):  [list(['21', '91', '177', '219', '339', '525', '630', '711', '789', '844', '886', '960', '1024', '1089', '1156', '1211', '1257', '1335', '1448', '1551', '1598', '1701', '1780', '1835', '1900', '1982', '2069', '2130', '2233', '2293', '2355', '2429', '2516', '2603', '2673', '2768', '2857', '2960', '3058', '3158', '3240', '3397', '3512', '3622', '3725', '3839', '3933', '4029', '4158', '4288', '4426', '4605', '4739', '4908', '5035', '5149', '5302', '5473', '5672', '5794', '5916', '6094', '6227', '6368', '6515', '6649', '6791', '6927', '7101', '7271', '7472', '7629', '7778', '7953'])
 list(['44', '112', '198', '258', '373', '555', '657', '733', '810', '865', '907', '981', '1045', '1113', '1177', '1236', '1278', '1359', '1469', '1577', '1647', '1735', '1811', '1871', '1928', '2026', '2097', '2168', '2263', '2324', '2387', '2483', '2562', '2638', '2709', '2806', '2912', '3011', '3113', '3199', '3282', '3443', '3556', '3675', '3779', '3886', '3981', '4094', '4216', '4339', '4478', '4675', '4793', '4963', '5091', '5206', '5381', '5532', '5734', '5855', '6001', '6157', '6291', '6433', '6583', '6724', '6859', '7005', '7171', '7356', '7544', '7705', '7852'])]
Arguments:  {'env_name': 'pong_v2', 'env_type': 'pettingzoo', 'num_envs': 1, 'ram': True, 'seed': 'random', 'algorithm': 'DQN', 'algorithm_spec': {'episodic_update': False, 'dueling': False, 'replay_buffer_size': '1e5', 'gamma': 0.99, 'multi_step': 1, 'target_update_interval': 1000, 'eps_start': 1.0, 'eps_final': 0.01, 'eps_decay': 30000}, 'batch_size': 128, 'max_episodes': 10000, 'max_steps_per_episode': 10000, 'train_start_frame': 0, 'optimizer': 'adam', 'learning_rate': '1e-4', 'device': 'gpu', 'update_itr': 1, 'log_avg_window': 20, 'log_interval': 20, 'render': False, 'test': False, 'exploit': True, 'load_model_idx': False, 'load_model_full_path': './data/model/20220119_0524/pettingzoo_pong_v2_fictitious_selfplay2/', 'multiprocess': False, 'eval_models': False, 'save_path': '', 'save_interval': 2000, 'net_architecture': {'hidden_dim_list': [128, 128, 128, 128], 'hidden_activation': 'ReLU', 'output_activation': False}, 'marl_method': 'fictitious_selfplay2', 'marl_spec': {'min_update_interval': 20, 'score_avg_window': 10, 'global_state': False, 'selfplay_score_delta': 30, 'trainable_agent_idx': 0, 'opponent_idx': 1}, 'against_baseline': False}
Save models to : /home/zihan/research/MARS/data/model/20220119_0524_exploit/pettingzoo_pong_v2_fictitious_selfplay2. 
 Save logs to: /home/zihan/research/MARS/data/log/20220119_0524_exploit/pettingzoo_pong_v2_fictitious_selfplay2.
Traceback (most recent call last):
  File "general_exploit.py", line 49, in <module>
    launch_rollout(parser_args.env, parser_args.method, parser_args.load_id, parser_args.save_id)
  File "general_exploit.py", line 41, in launch_rollout
    rollout(env, model, exploitation_args, save_id = load_id+'_exploit') # save results of exploitation in a separate folder
  File "/home/zihan/research/MARS/mars/rollout.py", line 21, in rollout
    rollout_normal(env, model, save_id, args)
  File "/home/zihan/research/MARS/mars/rollout.py", line 45, in rollout_normal
    obs_to_store)  # action: (agent, env, action_dim)
  File "/home/zihan/research/MARS/mars/rl/agents/multiagent.py", line 153, in choose_action
    action = agent.choose_action(state, Greedy=greedy)
  File "/home/zihan/research/MARS/mars/marl/meta_learner.py", line 16, in choose_action
    action = self.model.choose_action(state, *args, **kargs)
  File "/home/zihan/research/MARS/mars/rl/agents/dqn.py", line 89, in choose_action
    action = self.model.choose_action(state, epsilon)
  File "/home/zihan/research/MARS/mars/rl/agents/dqn.py", line 201, in choose_action
    q_value = self.net(state)
  File "/home/zihan/anaconda3/envs/x/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/zihan/research/MARS/mars/rl/common/networks.py", line 69, in forward
    x = self.body(x)
  File "/home/zihan/anaconda3/envs/x/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/zihan/anaconda3/envs/x/lib/python3.7/site-packages/torch/nn/modules/container.py", line 141, in forward
    input = module(input)
  File "/home/zihan/anaconda3/envs/x/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/zihan/anaconda3/envs/x/lib/python3.7/site-packages/torch/nn/modules/linear.py", line 103, in forward
    return F.linear(input, self.weight, self.bias)
  File "/home/zihan/anaconda3/envs/x/lib/python3.7/site-packages/torch/nn/functional.py", line 1958, in linear
    return torch._C._nn.linear(input, weight, bias)
RuntimeError: CUDA error: CUBLAS_STATUS_NOT_INITIALIZED when calling `cublasCreate(handle)`
